--CS 2550 Fall 2017
--Tyler Jacox
--SQL Assignment #4

--1
SELECT ROUND(AVG(COST), 2) AS "AVERAGE COST"
FROM COURSE;

--2
SELECT COUNT(*) AS January_Registrations
FROM STUDENT
WHERE TO_CHAR(REGISTRATION_DATE, 'fmMonth YYYY') = 'January 2007'
      AND REGISTRATION_DATE IS NOT NULL;

--3
SELECT
  AVG(NUMERIC_GRADE) AS Average,
  MAX(NUMERIC_GRADE) AS Highest,
  MIN(NUMERIC_GRADE) AS Lowest
FROM GRADE
WHERE GRADE_TYPE_CODE = 'FI'
      AND SECTION_ID = '152';
--4
SELECT
  CITY,
  STATE,
  COUNT(*) AS ZIPCODES
FROM ZIPCODE
GROUP BY CITY, STATE
HAVING COUNT(*) > 3
ORDER BY STATE, CITY;

--5
SELECT
  SECTION_ID,
  COUNT(*) AS ENROLLED
FROM ENROLLMENT
GROUP BY SECTION_ID, ENROLL_DATE
HAVING TO_CHAR(ENROLL_DATE, 'MM/DD/YYYY') = '02/21/2007'
ORDER BY ENROLLED DESC;

--6
SELECT
  STUDENT_ID,
  SECTION_ID,
  TO_CHAR(ROUND(AVG(NUMERIC_GRADE), 4), '99D9999') AS Average_Grade
FROM GRADE
GROUP BY STUDENT_ID, SECTION_ID
HAVING SECTION_ID = '86' AND SECTION_ID IS NOT NULL
ORDER BY STUDENT_ID;

--7
SELECT
  STUDENT_ID,
  COUNT(*) AS SECTIONS
FROM ENROLLMENT
GROUP BY STUDENT_ID
HAVING STUDENT_ID = '250';

--8
SELECT
  SECTION_ID,
  MIN(NUMERIC_GRADE) AS LOWSCORE
FROM GRADE
GROUP BY SECTION_ID, GRADE_TYPE_CODE
HAVING GRADE_TYPE_CODE = 'QZ' AND MIN(NUMERIC_GRADE) >= 80
ORDER BY SECTION_ID;

--9
SELECT
  EMPLOYER,
  COUNT(*) AS EMPLOYEES
FROM STUDENT
GROUP BY EMPLOYER
HAVING Count(*) > 5
ORDER BY EMPLOYEES;

--10

SELECT
  SECTION_ID,
  COUNT(*)           AS Participation_Grades,
  MIN(NUMERIC_GRADE) AS Lowest_Grade
FROM GRADE
GROUP BY SECTION_ID, GRADE_TYPE_CODE
HAVING GRADE_TYPE_CODE = 'PA' AND COUNT(*) > 15
ORDER BY SECTION_ID;






